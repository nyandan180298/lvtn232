"use strict";(self.webpackChunkluanvantotnghiep=self.webpackChunkluanvantotnghiep||[]).push([[893],{2275:function(e,n,t){var a=t(2791),r=t(9661),c=t(184),s=(0,a.memo)((function(e){var n=e.columns,t=e.data,a=e.rowKey;return t?(0,c.jsx)(r.Z,{columns:n,dataSource:t,rowKey:a,pagination:!1}):(0,c.jsx)(r.Z,{columns:n})}));n.Z=s},749:function(e,n,t){var a=t(3144),r=t(5671),c=t(136),s=t(7277),i=t(8397),u="/kho",o=function(e){(0,c.Z)(t,e);var n=(0,s.Z)(t);function t(){var e;(0,r.Z)(this,t);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=n.call.apply(n,[this].concat(c))).create=function(n){var t="".concat(u,"/create");return e.post(t,n)},e.detail=function(n){var t="".concat(u,"/get/").concat(n);return e.get(t)},e.update=function(n){var t="".concat(u,"/update/").concat(n.id);return e.post(t,n)},e.remove=function(n){var t="".concat(u,"/delete/").concat(n);return e.delete(t)},e}return(0,a.Z)(t)}(i.Z);n.Z=new o},3893:function(e,n,t){t.r(n),t.d(n,{default:function(){return ce}});var a=t(4165),r=t(1413),c=t(5861),s=t(9439),i=t(2791),u=t(1752),o=t(2143),l=t(9286),d=t(9529),h=t(9197),p=t(5458),m=t(2641),f=t(2275),Z=t(1079),g=t(3272),x=t(6591),v=t(1660),y=t(4228),j=t(1069),k=t(9435),b=t(1994),N=t(3340),C=t(3144),S=t(5671),I=t(136),w=t(7277),E=t(8397),M=function(e){(0,I.Z)(t,e);var n=(0,w.Z)(t);function t(){var e;(0,S.Z)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=n.call.apply(n,[this].concat(r))).remove=function(n){var t="".concat("/image","/delete/").concat(n);return e.delete(t)},e}return(0,C.Z)(t)}(E.Z),T=new M,P=t(9236),Y=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n,t){var c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.Z.create((0,r.Z)((0,r.Z)({},n),{},{kho:t}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),q=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n,t){var c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.Z.update((0,r.Z)((0,r.Z)({},n),{},{pid:t}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),D=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.Z.detail(n);case 2:if(!(t=e.sent).isSuccess){e.next=7;break}return e.abrupt("return",t.data);case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.remove(n);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),A=t(2351),H=t(184),O={name:"file",multiple:!1,headers:{authorization:"authorization-text","Access-Control-Allow-Origin":"*"},maxCount:1,action:"".concat(x.y8,"/image/upload"),listType:"picture"},R=function(e){var n=e.onClose,t=e.isModalVisible,a=e.type,c=e.handleRerender,u=e.pid,o=e.khoid,l=e.categories,d=e.nNs,h=(0,i.useState)({pId:"",name:"",quantity:"",price:"",ngayNhap:"",hanSd:"",category:"",nguonNhap:"",kho:o,image:{name:"",path:""}}),p=(0,s.Z)(h,2),f=p[0],Z=p[1];(0,i.useEffect)((function(){u&&D(u).then((function(e){Z((0,r.Z)({},e))}))}),[u]);var g=(0,i.useCallback)((function(e){_(e).then((function(e){e.isSuccess?N.Z.sendSuccess("X\xf3a h\xecnh th\xe0nh c\xf4ng!"):N.Z.sendError("Th\u1ea5t b\u1ea1i: ".concat(e.message))}))}),[]),x=(0,i.useCallback)((function(){f.pId.trim()?f.name.trim()?f.ngayNhap.trim()?f.hanSd.trim()?/^\d+$/.test(f.quantity)?/^\d+$/.test(f.price)?"add"===a?Y(f,o).then((function(e){e.isSuccess?(N.Z.sendSuccess("Th\xeam s\u1ea3n ph\u1ea9m th\xe0nh c\xf4ng!"),null===c||void 0===c||c(),n()):N.Z.sendError("Th\xeam s\u1ea3n ph\u1ea9m th\u1ea5t b\u1ea1i: ".concat(e.message))})):u&&q(f,u).then((function(e){e.isSuccess?(N.Z.sendSuccess("Ch\u1ec9nh s\u1eeda th\xf4ng tin th\xe0nh c\xf4ng!"),null===c||void 0===c||c(),n()):N.Z.sendError("Ch\u1ec9nh s\u1eeda th\xf4ng tin th\u1ea5t b\u1ea1i: ".concat(e.message))})):N.Z.sendError("Gi\xe1 ph\u1ea3i l\xe0 s\u1ed1"):N.Z.sendError("S\u1ed1 l\u01b0\u1ee3ng ph\u1ea3i l\xe0 s\u1ed1"):N.Z.sendError("Vui l\xf2ng nh\u1eadp h\u1ea1n s\u1eed d\u1ee5ng"):N.Z.sendError("Vui l\xf2ng nh\u1eadp ng\xe0y nh\u1eadp h\xe0ng"):N.Z.sendError("Vui l\xf2ng nh\u1eadp t\xean s\u1ea3n ph\u1ea9m"):N.Z.sendError("Vui l\xf2ng nh\u1eadp m\xe3 s\u1ea3n ph\u1ea9m")}),[f,n,a,u,c,o]);return(0,H.jsx)(j.Z,{title:"edit"===a?"Ch\u1ec9nh s\u1eeda th\xf4ng tin s\u1ea3n ph\u1ea9m":"Th\xeam s\u1ea3n ph\u1ea9m",className:"add-modal",open:t,okText:"edit"===a?"Ch\u1ec9nh s\u1eeda th\xf4ng tin":"Th\xeam s\u1ea3n ph\u1ea9m",cancelText:"H\u1ee7y",onCancel:n,onOk:x,width:695,centered:!0,children:(0,H.jsx)(k.Z,{className:"add-edit-form",children:(0,H.jsxs)("div",{className:"personal",children:[(0,H.jsx)(k.Z.Item,{label:"M\xe3 s\u1ea3n ph\u1ea9m",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.TEXT,value:f.pId||"",onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{pId:e}))},placeholder:"P001",className:"input-item"})}),(0,H.jsx)(k.Z.Item,{label:"T\xean s\u1ea3n ph\u1ea9m",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.TEXT,value:f.name||"",onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{name:e}))},placeholder:"S\u1ea3n Ph\u1ea9m",className:"input-item"})}),(0,H.jsx)(k.Z.Item,{label:"Gi\xe1 s\u1ea3n ph\u1ea9m",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.NUMBER,value:f.price||"",onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{price:e}))},placeholder:"Gi\xe1 s\u1ea3n ph\u1ea9m",className:"input-item"})}),(0,H.jsx)(k.Z.Item,{label:"S\u1ed1 l\u01b0\u1ee3ng",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.NUMBER,value:f.quantity||"",onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{quantity:e}))},placeholder:"S\u1ed1 l\u01b0\u1ee3ng",className:"input-item"})}),(0,H.jsx)(k.Z.Item,{label:"Ng\xe0y nh\u1eadp h\xe0ng",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.DATETIME,value:f.ngayNhap||"",onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{ngayNhap:e}))},placeholder:"DD/MM/YYYY HH:mm",className:"input-item"})}),(0,H.jsx)(k.Z.Item,{label:"H\u1ea1n s\u1eed d\u1ee5ng",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.DATETIME,value:f.hanSd||"",onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{hanSd:e}))},placeholder:"DD/MM/YYYY HH:mm",className:"input-item"})}),l&&(0,H.jsx)(k.Z.Item,{label:"Danh M\u1ee5c",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.SELECT,value:f.category,onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{category:e}))},placeholder:"Th\u1ef1c ph\u1ea9m",className:"input-item",options:l.map((function(e,n){return{key:n,value:e._id,label:e.name}}))})}),d&&(0,H.jsx)(k.Z.Item,{label:"Ngu\u1ed3n Nh\u1eadp",required:!0,children:(0,H.jsx)(v.Z,{type:y.I.SELECT,value:f.nguonNhap,onChange:function(e){return Z((0,r.Z)((0,r.Z)({},f),{},{nguonNhap:e}))},placeholder:"Ngu\u1ed3n Nh\u1eadp",className:"input-item",options:d.map((function(e,n){return{key:n,value:e._id,label:e.name}}))})}),(0,H.jsx)(k.Z.Item,{label:"H\xecnh \u1ea3nh",required:!0,children:(0,H.jsx)(b.Z,(0,r.Z)((0,r.Z)({},O),{},{onChange:function(e){e.file.status,"done"===e.file.status?(Z((0,r.Z)((0,r.Z)({},f),{},{image:{name:e.file.name,path:e.file.response.data.filepath}})),N.Z.sendSuccess("".concat(e.file.name," file uploaded successfully"))):"error"===e.file.status&&N.Z.sendError("".concat(e.file.name," file upload failed."))},onRemove:function(e){var n=e.response.data.filepath.split("\\")[2];e&&g(n)},children:(0,H.jsx)(m.ZP,{icon:(0,H.jsx)(A.Z,{}),children:"Ch\u1ecdn \u1ea3nh"})}))})]})})})},V=(0,i.memo)(R),K=t(563),G=t(749),L=t(8488),X=t(8687),z=t(886),U=t(7892),$=t.n(U),B=t(4869),F="".concat(x.y8,"/category"),J="".concat(x.y8,"/nguon-nhap"),Q=(0,i.memo)((function(e){var n=e.data,t=e.onPaginate,r=e.pageObj,v=e.handleRerender,y=e.khoId,j=e.order,k=(0,i.useState)(!1),b=(0,s.Z)(k,2),C=b[0],S=b[1],I=(0,i.useState)(!1),w=(0,s.Z)(I,2),E=w[0],M=w[1],T=(0,i.useState)([]),P=(0,s.Z)(T,2),Y=P[0],q=P[1],D=(0,i.useState)([]),_=(0,s.Z)(D,2),A=_[0],O=_[1],R=(0,i.useState)(""),X=(0,s.Z)(R,2),U=X[0],Q=X[1],W=(0,i.useState)([]),ee=(0,s.Z)(W,2),ne=ee[0],te=ee[1],ae=(0,i.useState)(!0),re=(0,s.Z)(ae,2),ce=re[0],se=re[1],ie=(0,i.useCallback)((0,c.Z)((0,a.Z)().mark((function e(){var n,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(F,"/getAll"));case 2:return n=e.sent,e.next=5,n.json();case 5:(t=e.sent)&&q(t.data);case 7:case"end":return e.stop()}}),e)}))),[]),ue=(0,i.useCallback)((0,c.Z)((0,a.Z)().mark((function e(){var n,t,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.Z.detail(y);case 2:return n=e.sent,t=n.data.nguonNhaps,e.next=6,Promise.all(t.map(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var t,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(J,"/get/").concat(n));case 2:return t=e.sent,e.next=5,t.json();case 5:return r=e.sent,e.abrupt("return",{_id:r.data._id,name:r.data.name,phone_num:r.data.phone_num});case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 6:(r=e.sent)&&O(r);case 8:case"end":return e.stop()}}),e)}))),[y]);(0,i.useEffect)((function(){te(j.products)}),[j]),(0,i.useEffect)((function(){ie(),ue()}),[ie,ue]);var oe=(0,i.useCallback)((function(){v(),S(!1)}),[v]),le=(0,i.useCallback)((function(){v(),M(!1)}),[v]),de=(0,i.useCallback)((function(e,n){return(0,H.jsx)(m.ZP,{className:"edit-button",onClick:function(){Q(n.id),M(!0)},children:(0,H.jsx)(u.Z,{style:{color:"red"}})})}),[]),he=(0,i.useCallback)((function(e){return 0===e?(0,H.jsx)("p",{className:"red bold font_italic",children:e}):(0,H.jsx)("p",{children:e})}),[]),pe=(0,i.useCallback)((function(e,n){var t=-Math.ceil($()().diff(n.hanSd)/864e5);return 0!==n.quantity&&t>0?ne.includes(n.id)?(0,H.jsx)(m.ZP,{className:"add-order-button",onClick:function(){(0,L.Er)(n.id),N.Z.sendSuccess("X\xf3a s\u1ea3n ph\u1ea9m ".concat(n.name," ra kh\u1ecfi \u0111\u01a1n th\xe0nh c\xf4ng"))},children:(0,H.jsx)(o.Z,{style:{color:"black"}})}):(0,H.jsx)(m.ZP,{className:"add-order-button",onClick:function(){(0,L.pj)(n.id),N.Z.sendSuccess("Th\xeam s\u1ea3n ph\u1ea9m ".concat(n.name," th\xe0nh c\xf4ng"))},children:(0,H.jsx)(l.Z,{style:{color:"black"}})}):(0,H.jsx)("div",{className:"blank"})}),[ne]),me=(0,i.useMemo)((function(){return[{title:"",dataIndex:"",key:"actionAddOrder",render:pe},{title:"M\xe3 s\u1ea3n ph\u1ea9m",dataIndex:"pId",key:"pId"},{title:"T\xean s\u1ea3n ph\u1ea9m",dataIndex:"name",key:"name"},{title:"Gi\xe1 b\xe1n",dataIndex:"price",key:"price"},{title:"Lo\u1ea1i H\xe0ng",dataIndex:"category",key:"category"},{title:"S\u1ed1 l\u01b0\u1ee3ng",dataIndex:"quantity",key:"quantity",render:function(e){return he(e)}},{title:"Ngu\u1ed3n nh\u1eadp",dataIndex:"nguonNhap",key:"nguonNhap"},{title:"Ng\xe0y nh\u1eadp kho",dataIndex:"ngayNhap",key:"ngayNhap",render:function(e){return fe(e)}},{title:"H\u1ea1n s\u1eed d\u1ee5ng",dataIndex:"hanSd",key:"hanSd",render:function(e){return Ze(e)}},{title:"",dataIndex:"",key:"action",render:de}]}),[pe,de,he]),fe=function(e){return(0,H.jsx)("p",{children:e&&$()(e).format("DD/MM/YYYY")})},Ze=function(e){return-Math.ceil($()().diff(e)/864e5)<=0?(0,H.jsx)("p",{className:"red bold font_italic",children:e&&$()(e).format("DD/MM/YYYY")}):(0,H.jsx)("p",{children:e&&$()(e).format("DD/MM/YYYY")})};return(0,H.jsxs)("div",{className:"table-container",children:[(0,H.jsxs)("div",{children:[(0,H.jsxs)("div",{className:"search-add-bar",children:[(0,H.jsxs)("div",{className:"search-div",children:[(0,H.jsx)(Z.Z,{}),(0,H.jsxs)("a",{className:"link-customer",href:"".concat("https://lvtn-2024.web.app/","/#/").concat(y),children:["Link ",(0,H.jsx)(d.Z,{})]})]}),(0,H.jsx)("div",{className:"add-div",children:(0,H.jsxs)(m.ZP,{className:"add-button",onClick:function(){return S(!0)},children:[(0,H.jsx)(K.Z,{}),"Th\xeam S\u1ea3n Ph\u1ea9m"]})}),C&&(0,H.jsx)(V,{onClose:oe,isModalVisible:C,type:"add",khoid:y,categories:Y,nNs:A}),E&&(0,H.jsx)(V,{onClose:le,isModalVisible:E,type:"edit",khoid:y,categories:Y,nNs:A,pid:U})]}),(0,H.jsxs)("div",{className:"filter-div",children:[(0,H.jsx)(z.Z,{categories:Y,handleRerender:v}),(0,H.jsxs)("div",{className:"views-switch",children:[(0,H.jsx)("div",{className:"view-button"+(ce?"_active":""),children:(0,H.jsx)(h.Z,{onClick:function(){return se(!0)}})}),(0,H.jsx)("div",{className:"view-button"+(ce?"":"_active"),children:(0,H.jsx)(p.Z,{onClick:function(){return se(!1)}})})]})]}),ce?(0,H.jsx)(f.Z,{columns:me,data:n,rowKey:function(e){return e.id}}):(0,H.jsx)(B.Z,{data:n,addOrderFormat:pe})]}),(0,H.jsx)(g.Z,{title:"S\u1ea3n Ph\u1ea9m",pageSize:x.Ky,totalRow:r&&r.total,currentPage:r&&r.page,totalPage:r&&r.totalPage,onPaginate:t})]})})),W=(0,X.$j)((function(e){return{order:e.order}}))(Q),ee=t(7689),ne=t(1087),te="".concat(x.y8,"/nguon-nhap"),ae="".concat(x.y8,"/category"),re=(0,i.memo)((function(){var e=(0,ee.UO)().id,n=(0,ne.lr)(),t=(0,s.Z)(n,2),u=t[0],o=t[1],l=(0,i.useState)(!1),d=(0,s.Z)(l,2),h=d[0],p=d[1],m=(0,i.useCallback)((function(){p(!h)}),[h]),f=(0,i.useState)([]),Z=(0,s.Z)(f,2),g=Z[0],x=Z[1],v=(0,i.useState)({page:0,total:0,totalPage:0}),y=(0,s.Z)(v,2),j=y[0],k=y[1],b=(0,i.useCallback)((function(e){u.set("page",e),o(u)}),[u,o]),N=(0,i.useCallback)(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n,t){var s,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={params:t},e.next=3,P.Z.getAll(n,s);case 3:if((i=e.sent).data||x([]),!i.isSuccess){e.next=9;break}Promise.all(i.data.data.map(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(n){var t,c,s,i,u,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.nguonNhap||!n.category){e.next=14;break}return e.next=3,fetch("".concat(te,"/get/").concat(n.nguonNhap));case 3:return t=e.sent,e.next=6,t.json();case 6:return c=e.sent,e.next=9,fetch("".concat(ae,"/get/").concat(n.category));case 9:return s=e.sent,e.next=12,s.json();case 12:return i=e.sent,e.abrupt("return",(0,r.Z)((0,r.Z)({},n),{},{nguonNhap:c.data.name,category:i.data.name}));case 14:if(!n.category){e.next=22;break}return e.next=17,fetch("".concat(ae,"/get/").concat(n.category));case 17:return u=e.sent,e.next=20,u.json();case 20:return o=e.sent,e.abrupt("return",(0,r.Z)((0,r.Z)({},n),{},{category:o.data.name}));case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())).then((function(e){return x(e)})).catch((function(e){return console.error(e)})),e.next=10;break;case 9:return e.abrupt("return");case 10:k({page:i.data.page,total:i.data.total,totalPage:i.data.totalPage});case 11:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),[]);return(0,i.useEffect)((function(){var n=Object.fromEntries(u.entries());N({khoid:e},n)}),[N,u,e,h]),g&&(0,H.jsx)(W,{data:g,onPaginate:b,pageObj:j,handleRerender:m,khoId:e})}));re.displayName="KhoSanPham";var ce=re}}]);
//# sourceMappingURL=893.d3606081.chunk.js.map